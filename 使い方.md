# 生徒現状報告書チェッカー 使い方

## 概要
このアプリケーションは、塾の生徒現状報告書（Excelファイル）を自動的にチェックし、以下の点を検証します：
- テストスコアの妥当性
- 文章量の適切性
- 誤字脱字
- 各項目の内容が適切かどうか

## インストール方法

1. Pythonがインストールされていることを確認してください（Python 3.7以上推奨）

2. 必要なパッケージをインストールします：
```bash
pip install -r requirements.txt
```

## 使用方法

1. アプリケーションを起動します：
```bash
python excel_validator.py
```

2. **ファイル選択**（以下のいずれかの方法）
   - **ドラッグ&ドロップ**: Excelファイルを灰色のエリアにドラッグ&ドロップ（自動的にチェックが開始されます）
   - 「ファイルを選択」ボタンをクリックして、チェックしたいExcelファイルを選択
   - ファイルパスを直接入力欄に入力

3. **チェック設定**
   - 実行したいチェック項目を選択します：
     - テストスコアの妥当性：点数が0-100の範囲内か、合計が正しいかなどをチェック
     - 文章量の適切性：各項目の文字数が適切な範囲内かチェック
     - 誤字脱字チェック：よくある誤字や文字の繰り返しをチェック
     - 内容の適切性：各項目に期待されるキーワードが含まれているかチェック

4. **チェック実行**
   - 「チェック実行」ボタンをクリックすると、選択したチェックが実行されます

5. **結果の確認**
   - チェック結果は表形式で表示されます
   - 重要度によって色分けされます：
     - 赤：エラー（必ず修正が必要）
     - オレンジ：警告（修正を推奨）
     - 青：情報（参考情報）
     - 緑：成功（問題なし）

6. **レポート保存**
   - 「レポート保存」ボタンで結果をテキストファイルまたはJSONファイルとして保存できます

## チェック内容の詳細

### テストスコアのチェック
- 各科目の点数が0-100点の範囲内か
- 合計点が各科目の合計と一致するか
- 順位が1以上の値か
- 未入力の項目がないか

### 文章量のチェック
各項目に推奨される文字数：
- 現在の学習課題：100-500文字
- 課題に対する進捗状況：100-500文字
- 今後の目標：50-300文字
- 目標に向けた指導計画：100-500文字
- 授業態度・意欲・遅刻等：50-400文字
- 宿題について：50-400文字
- 家庭学習アドバイス：100-500文字
- 夏期講習提案理由：50-300文字

### 誤字脱字チェック
- よくある誤字（例：「ゆう」→「いう」）
- 同じ文字の過度な繰り返し
- 長い文章での句読点不足

### 内容の適切性チェック

各項目の内容が適切かどうかを以下の観点でチェックします：

1. **キーワード分析**
   - 各項目に期待される専門用語やキーワードが含まれているか
   - キーワードの出現率を計算し、20%未満の場合は警告

2. **ネガティブパターン検出**
   - 「特になし」「問題なし」など、具体性に欠ける表現を検出
   - 各項目の目的に反する表現をチェック

3. **文章構成チェック**
   - 各項目に推奨される最小文数を満たしているか
   - 句読点で区切られた文の数をカウント

4. **具体性の評価**
   - 数値や期限などの具体的な情報が含まれているか
   - 特に「今後の目標」や「指導計画」では数値の有無を確認

#### 各項目の検証ルール

- **現在の学習課題**: 具体的な科目・単元、問題点の説明（2文以上推奨）
- **課題に対する進捗状況**: 具体的な取り組み内容、結果や変化（2文以上推奨）
- **今後の目標**: 具体的な数値目標、期限（1文以上、数値を含むこと推奨）
- **目標に向けた指導計画**: 具体的な指導方法、実施頻度や期間（2文以上推奨）
- **授業態度・意欲・遅刻等**: 態度の評価、具体的な行動（1文以上）
- **宿題について**: 提出状況、取り組みの質（1文以上）
- **家庭学習アドバイス**: 具体的な学習方法、時間や頻度の提案（2文以上推奨）

## 文字化け問題の対処法

もし日本語が正しく表示されない（文字化けする）場合は、以下の対処法を試してください：

### 1. 環境変数の設定
ターミナルで以下のコマンドを実行してください：
```bash
export LANG=ja_JP.UTF-8
# または
export LANG=C.UTF-8

export PYTHONIOENCODING=utf-8
```

### 2. 診断スクリプトの実行
文字化けの原因を調べるために、以下のスクリプトを実行してください：
```bash
python3 encoding_test.py
```

### 3. WSL（Windows Subsystem for Linux）をお使いの場合
Windows PowerShellまたはコマンドプロンプトで以下を実行してください：
```cmd
chcp 65001
```
その後、WSLターミナルで：
```bash
export LANG=C.UTF-8
```

### 4. それでも解決しない場合
- ターミナルエミュレータの設定でUTF-8エンコーディングが有効になっているか確認
- 使用しているフォントが日本語に対応しているか確認
- 異なるターミナルエミュレータ（例：Windows Terminal、iTerm2など）で試してみる

## 注意事項
- このツールは補助的なチェックを行うものです。最終的な確認は必ず人の目で行ってください
- 日本語の文章チェックは完全ではありません。文脈に応じた判断が必要です
- Excelファイルの形式が変更された場合は、正しく動作しない可能性があります