# 生徒現状報告書チェッカー

塾の生徒現状報告書（Excelファイル）を自動的にチェックし、テストスコアの妥当性、文章量の適切性、誤字脱字、各項目の内容適切性を検証するツールです。

## 📋 主な機能

- **テストスコア検証**: 点数の範囲（0-100点）、合計点の計算確認
- **文章量チェック**: 各項目の推奨文字数との比較
- **誤字脱字検出**: よくある誤字や文字の過度な繰り返しを検出
- **内容適切性確認**: 各項目に期待されるキーワードの有無を確認
- **GUI操作**: ドラッグ&ドロップ対応の直感的なインターフェース
- **レポート出力**: チェック結果をテキストまたはJSONで保存

## 🚀 ワンクリック実行

### Windows（WSL）/ Linux / macOS

```bash
# 実行権限を付与（初回のみ）
chmod +x run_gui.sh

# ワンクリック実行
./run_gui.sh
```

### Windows（直接実行）

```cmd
python excel_validator.py
```

## 📦 インストール方法

### 前提条件
- Python 3.7以上
- tkinter（通常Pythonに含まれています）

### パッケージのインストール

```bash
pip install -r requirements.txt
```

## 💻 使用方法

### 1. アプリケーション起動

```bash
python excel_validator.py
```

### 2. ファイル選択（3つの方法）

- **ドラッグ&ドロップ**: Excelファイルを灰色のエリアにドラッグ（自動チェック開始）
- **ファイル選択ボタン**: 「ファイルを選択」をクリック
- **パス直接入力**: ファイルパスを入力欄に直接入力

### 3. チェック項目設定

チェックしたい項目を選択：
- ✅ **テストスコアの妥当性**
- ✅ **文章量の適切性**  
- ✅ **誤字脱字チェック**
- ✅ **内容の適切性**

### 4. 結果確認

チェック結果は色分け表示：
- 🔴 **エラー**: 必ず修正が必要
- 🟠 **警告**: 修正を推奨
- 🔵 **情報**: 参考情報
- 🟢 **成功**: 問題なし

### 5. レポート出力

「レポート保存」ボタンでTXTまたはJSON形式で結果を保存できます。

## 📊 チェック内容詳細

### テストスコア検証
- 各科目: 0-100点の範囲チェック
- 合計点: 各科目の合計との整合性確認
- 順位: 1以上の値であることを確認
- 未入力項目の検出

### 文章量チェック（推奨文字数）
- 現在の学習課題: 100-500文字
- 課題に対する進捗状況: 100-500文字
- 今後の目標: 50-300文字
- 目標に向けた指導計画: 100-500文字
- 授業態度・意欲・遅刻等: 50-400文字
- 宿題について: 50-400文字
- 家庭学習アドバイス: 100-500文字
- 夏期講習提案理由: 50-300文字

### 誤字脱字検出
- よくある誤字（例: 「ゆう」→「いう」）
- 同じ文字の過度な繰り返し
- 長文での句読点不足

### 内容適切性チェック
- キーワード分析（各項目20%以上の関連キーワード推奨）
- ネガティブパターン検出（「特になし」等の具体性不足表現）
- 文章構成確認（推奨文数との比較）
- 具体性評価（数値や期限の有無）

## 🛠 文字化け対処法

### 1. 環境変数設定

```bash
export LANG=ja_JP.UTF-8
export PYTHONIOENCODING=utf-8
```

### 2. WSL環境の場合

```cmd
# Windows側で実行
chcp 65001

# WSL側で実行
export LANG=C.UTF-8
```

### 3. 診断スクリプト実行

```bash
python3 encoding_test.py
```

## 📁 ファイル構成

```
check_excel/
├── README.md                    # このファイル
├── excel_validator.py           # メインアプリケーション
├── excel_validator_cli.py       # CLI版（オプション）
├── analyze_excel.py            # 分析用スクリプト
├── encoding_test.py            # エンコーディング診断
├── requirements.txt            # 依存パッケージ
├── run_gui.sh                  # ワンクリック実行スクリプト
├── 使い方.md                   # 詳細な使い方（日本語）
└── 宮下綾介2023夏期現状報告書-前川.xlsx  # サンプルファイル
```

## ⚠️ 注意事項

- このツールは補助的なチェックツールです。最終確認は必ず人の目で行ってください
- 日本語の文章チェックは完全ではありません。文脈に応じた判断が必要です
- Excelファイルの形式が変更された場合、正しく動作しない可能性があります

## 🔧 トラブルシューティング

### GUI が起動しない場合
1. X11転送が有効になっているか確認
2. WSLGまたはX410等のX Serverが起動しているか確認
3. `run_gui.sh`を使用してみる

### ファイルが読み込めない場合
1. ファイルパスに日本語が含まれていないか確認
2. ファイルが他のアプリケーションで開かれていないか確認
3. Excel形式が.xlsxまたは.xlsであることを確認

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。